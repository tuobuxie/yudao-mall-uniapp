import{v as a,o as e,aE as o,r as t,e as i,f as s,w as r,S as n,c7 as l,j as c,l as g,m as p,F as m,g as d,k as u,u as f,s as k,p as _,t as P,D as b,$ as y,ah as M,i as S,H as h}from"./index-kPUodEo8.js";import{_ as x}from"./s-goods-item.nGp3A0wy.js";import{_ as j}from"./s-empty.B9iGK6-f.js";import{_ as w}from"./uni-load-more.8Kzkyk-l.js";import{S as v}from"./s-layout.ChN2kRO2.js";import{f as C}from"./useGoods.CNv-03RG.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{c as $}from"./concat.CXHZS4ws.js";const z=I({__name:"goods",setup(I){const z=a({pagination:{list:[],total:0,pageNo:1,pageSize:8},loadStatus:"",shareInfo:{}});async function N(){z.loadStatus="loading";let{code:a,data:e}=await n.getSpuPage({pageSize:z.pagination.pageSize,pageNo:z.pagination.pageNo});0===a?(await Promise.all(e.list.map((async a=>{try{const e=await l.getProductBrokeragePrice(a.id);a.brokerageMinPrice=e.data.brokerageMinPrice,a.brokerageMaxPrice=e.data.brokerageMaxPrice}catch(e){console.error(`获取商品【${a.name}】的佣金时出错：`,e)}}))),z.pagination.list=$(z.pagination.list,e.list),z.pagination.total=e.total,z.loadStatus=z.pagination.list.length<z.pagination.total?"more":"noMore"):z.loadStatus="error"}function B(){"noMore"!==z.loadStatus&&(z.pagination.pageNo++,N())}return e((()=>{N()})),o((()=>{B()})),(a,e)=>{const o=S,n=h,l=t(i("s-goods-item"),x),I=t(i("s-empty"),j),$=t(i("uni-load-more"),w),N=t(i("s-layout"),v);return c(),s(N,{title:"推广商品",onShareAppMessage:z.shareInfo},{default:r((()=>[(c(!0),g(m,null,p(z.pagination.list,(a=>(c(),s(o,{class:"goods-item ss-m-20",key:a.id},{default:r((()=>[u(l,{size:"lg",img:a.picUrl,title:a.name,subTitle:a.introduction,price:a.price,originPrice:a.marketPrice,priceColor:"#333",onClick:e=>f(k).$router.go("/pages/goods/index",{id:a.id})},{rightBottom:r((()=>[u(o,{class:"ss-flex ss-row-between"},{default:r((()=>[void 0===a.brokerageMinPrice?(c(),s(o,{key:0,class:"commission-num"},{default:r((()=>[_(" 预计佣金：计算中 ")])),_:1})):a.brokerageMinPrice===a.brokerageMaxPrice?(c(),s(o,{key:1,class:"commission-num"},{default:r((()=>[_(" 预计佣金："+P(f(C)(a.brokerageMinPrice)),1)])),_:2},1024)):(c(),s(o,{key:2,class:"commission-num"},{default:r((()=>[_(" 预计佣金："+P(f(C)(a.brokerageMinPrice))+" ~ "+P(f(C)(a.brokerageMaxPrice)),1)])),_:2},1024)),u(n,{class:"ss-reset-button share-btn ui-BG-Main-Gradient",onClick:b((e=>{return o=a,z.shareInfo=y.getShareInfo({title:o.name,image:k.$url.cdn(o.picUrl),desc:o.introduction,params:{page:"2",query:o.id}},{type:"goods",title:o.name,image:k.$url.cdn(o.picUrl),price:C(o.price),original_price:C(o.marketPrice)}),void M();var o}),["stop"])},{default:r((()=>[_(" 分享赚 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["img","title","subTitle","price","originPrice","onClick"])])),_:2},1024)))),128)),0===z.pagination.total?(c(),s(I,{key:0,icon:"/static/goods-empty.png",text:"暂无推广商品"})):d("",!0),z.pagination.total>0?(c(),s($,{key:1,status:z.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:B},null,8,["status"])):d("",!0)])),_:1},8,["onShareAppMessage"])}}},[["__scopeId","data-v-77f789ab"]]);export{z as default};
