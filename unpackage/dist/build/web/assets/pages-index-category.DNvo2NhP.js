import{j as t,f as a,w as s,k as e,p as o,t as l,l as i,F as n,m as c,u as r,s as d,i as u,q as g,r as p,e as f,v as _,c as y,o as m,C as v,x,S as k,y as b,g as w,z as h,A as M}from"./index-kPUodEo8.js";import{_ as S}from"./uni-load-more.8Kzkyk-l.js";import{S as j}from"./s-layout.ChN2kRO2.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as L}from"./s-goods-column.CAq6vgsX.js";import{f as N}from"./useGoods.CNv-03RG.js";import{c as I}from"./concat.CXHZS4ws.js";const $=C({__name:"second-one",props:{data:{type:Object,default:()=>({})},activeMenu:[Number,String]},setup(p){const f=p;return(_,y)=>{const m=u,v=g;return t(),a(m,null,{default:s((()=>[e(m,{class:"title-box ss-flex ss-col-center ss-row-center ss-p-b-30"},{default:s((()=>[e(m,{class:"title-line-left"}),e(m,{class:"title-text ss-p-x-20"},{default:s((()=>[o(l(f.data[p.activeMenu].name),1)])),_:1}),e(m,{class:"title-line-right"})])),_:1}),e(m,{class:"goods-item-box ss-flex ss-flex-wrap ss-p-b-20"},{default:s((()=>[(t(!0),i(n,null,c(f.data[p.activeMenu].children,(i=>(t(),a(m,{class:"goods-item",key:i.id,onClick:t=>r(d).$router.go("/pages/goods/list",{categoryId:i.id})},{default:s((()=>[e(v,{class:"goods-img",src:i.picUrl,mode:"aspectFill"},null,8,["src"]),e(m,{class:"ss-p-10"},{default:s((()=>[e(m,{class:"goods-title ss-line-1"},{default:s((()=>[o(l(i.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})}}},[["__scopeId","data-v-2c759fd1"]]),z=C({__name:"first-one",props:{pagination:Object},setup:o=>(l,g)=>{const _=p(f("s-goods-column"),L),y=u;return t(),a(y,{class:"ss-flex-col"},{default:s((()=>[(t(!0),i(n,null,c(o.pagination.list,(o=>(t(),a(y,{class:"goods-box",key:o.id},{default:s((()=>[e(_,{size:"sl",data:o,onClick:t=>r(d).$router.go("/pages/goods/index",{id:o.id})},null,8,["data","onClick"])])),_:2},1024)))),128))])),_:1})}},[["__scopeId","data-v-029ac68c"]]),F=C({__name:"first-two",props:{pagination:Object},setup:p=>(f,_)=>{const y=g,m=u;return t(),a(m,null,{default:s((()=>[e(m,{class:"ss-flex flex-wrap"},{default:s((()=>{var u;return[(t(!0),i(n,null,c(null==(u=p.pagination)?void 0:u.list,(i=>(t(),a(m,{class:"goods-box",key:i.id},{default:s((()=>[e(m,{onClick:t=>r(d).$router.go("/pages/goods/index",{id:i.id})},{default:s((()=>[e(m,{class:"goods-img"},{default:s((()=>[e(y,{class:"goods-img",src:i.picUrl,mode:"aspectFit"},null,8,["src"])])),_:2},1024),e(m,{class:"goods-content"},{default:s((()=>[e(m,{class:"goods-title ss-line-1 ss-m-b-28"},{default:s((()=>[o(l(i.name),1)])),_:2},1024),e(m,{class:"goods-price"},{default:s((()=>[o("￥"+l(r(N)(i.price)),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128))]})),_:1})])),_:1})}},[["__scopeId","data-v-dc60d353"]]),O=C({__name:"category",setup(C){const L=_({style:"first_one",categoryList:[],activeMenu:0,pagination:{list:[],total:[],pageNo:1,pageSize:6},loadStatus:""}),{safeArea:N}=d.$platform.device,O=y((()=>N.height-44-50)),U=2*d.$platform.device.statusBarHeight;const A=t=>{L.activeMenu=t,"first_one"!==L.style&&"first_two"!==L.style||(L.pagination.pageNo=1,L.pagination.list=[],L.pagination.total=0,q())};async function q(){L.loadStatus="loading";const t=await k.getSpuPage({categoryId:L.categoryList[L.activeMenu].id,pageNo:L.pagination.pageNo,pageSize:L.pagination.pageSize});0===t.code&&(L.pagination.list=I(L.pagination.list,t.data.list),L.pagination.total=t.data.total,L.loadStatus=L.pagination.list.length<L.pagination.total?"more":"noMore")}function B(){"noMore"!==L.loadStatus&&(L.pagination.pageNo++,q())}return m((async t=>{await async function(){const{code:t,data:a}=await v.getCategoryList();0===t&&(L.categoryList=x(a))}();const a=L.categoryList.find((a=>a.id===Number(t.id)));A(a?L.categoryList.indexOf(a):0)})),(_,y)=>{const m=u,v=h,x=g,k=p(f("uni-load-more"),S),C=p(f("s-layout"),j);return t(),a(C,{bgStyle:{color:"#fff"},tabbar:"/pages/index/category",title:"分类"},{default:s((()=>[e(m,{class:"s-category"},{default:s((()=>[e(m,{class:"three-level-wrap ss-flex ss-col-top"},{default:s((()=>{var u;return[e(m,{class:"side-menu-wrap",style:b([{top:Number(U+88)+"rpx"}])},{default:s((()=>[e(v,{"scroll-y":"",style:b([{height:O.value+"px"}])},{default:s((()=>[(t(!0),i(n,null,c(L.categoryList,((i,n)=>(t(),a(m,{class:M(["menu-item ss-flex",[{"menu-item-active":n===L.activeMenu}]]),key:i.id,onClick:t=>A(n)},{default:s((()=>[e(m,{class:"menu-title ss-line-1"},{default:s((()=>[o(l(i.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["style"])])),_:1},8,["style"]),(null==(u=L.categoryList)?void 0:u.length)?(t(),a(m,{key:0,class:"goods-list-box"},{default:s((()=>[e(v,{"scroll-y":"",style:b([{height:O.value+"px"}])},{default:s((()=>[L.categoryList[L.activeMenu].picUrl?(t(),a(x,{key:0,class:"banner-img",src:r(d).$url.cdn(L.categoryList[L.activeMenu].picUrl),mode:"widthFix"},null,8,["src"])):w("",!0),"first_one"===L.style?(t(),a(z,{key:1,pagination:L.pagination},null,8,["pagination"])):w("",!0),"first_two"===L.style?(t(),a(F,{key:2,pagination:L.pagination},null,8,["pagination"])):w("",!0),"second_one"===L.style?(t(),a($,{key:3,data:L.categoryList,activeMenu:L.activeMenu},null,8,["data","activeMenu"])):w("",!0),("first_one"===L.style||"first_two"===L.style)&&L.pagination.total>0?(t(),a(k,{key:4,status:L.loadStatus,"content-text":{contentdown:"点击查看更多"},onClick:B},null,8,["status"])):w("",!0)])),_:1},8,["style"])])),_:1})):w("",!0)]})),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-38b1c323"]]);export{O as default};
