import{X as e,v as s,o as a,s as t,a4 as l,aM as o,r,e as i,f as u,w as d,j as c,k as n,p as f,l as p,m,F as _,t as y,u as x,aO as h,aP as w,af as g,i as b,aQ as v,G as k,H as I,I as M,J as V}from"./index-Ch_jkemp.js";import{_ as C}from"./s-goods-item.DcngbUKh.js";import{g as j,i as R,_ as G,c as P,S as U}from"./s-layout.Ckk_oEQ_.js";import{_ as L}from"./s-uploader.pQcKAWFG.js";import{f as B}from"./useGoods.CmR2wUi_.js";import{_ as S}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./choose-and-upload-file.Bi8hjSC9.js";const D=S({__name:"apply",setup(S){const D=e(null),T=s({orderId:0,itemId:0,order:{},item:{},config:{},wayList:[{text:"仅退款",value:"10"},{text:"退款退货",value:"20"}],reasonList:[],showModal:!1,currentValue:""});let $=s({way:"",applyReason:"",applyDescription:"",applyPicUrls:[]});const H=s({});async function N(){let e={orderItemId:T.itemId,refundPrice:T.item.payPrice,...$};const{code:s}=await w.createAfterSale(e);0===s&&(g({title:"申请成功"}),t.$router.redirect("/pages/order/aftersale/list"))}function O(e){$.way=e.detail.value,T.reasonList="10"===$.way?T.config.afterSaleRefundReasons||[]:T.config.afterSaleReturnReasons||[],$.applyReason="",T.currentValue=""}function A(e){T.currentValue=e.detail.value}function F(){$.applyReason=T.currentValue,T.showModal=!1}return a((async e=>{if(!e.orderId||!e.itemId)return void t.$helper.toast("缺少订单信息，请检查");T.orderId=e.orderId,T.itemId=parseInt(e.itemId);const{code:s,data:a}=await l.getOrderDetail(T.orderId);0===s&&(T.order=a,T.item=a.items.find((e=>e.id===T.itemId))||{},10===T.order.status&&T.wayList.splice(1,1),T.config=(await o.getTradeConfig()).data)})),(e,s)=>{const a=r(i("s-goods-item"),C),l=b,o=M,w=V,g=v,S=k,J=r(i("uni-easyinput"),j),Q=r(i("s-uploader"),L),X=r(i("uni-forms"),R),Z=I,q=r(i("su-fixed"),G),z=r(i("su-popup"),P),E=r(i("s-layout"),U);return c(),u(E,{title:"申请售后"},{default:d((()=>[n(l,{class:"goods-box"},{default:d((()=>{var e;return[n(a,{img:T.item.picUrl,title:T.item.spuName,skuText:null==(e=T.item.properties)?void 0:e.map((e=>e.valueName)).join(" "),price:T.item.price,num:T.item.count},null,8,["img","title","skuText","price","num"])]})),_:1}),n(X,{ref_key:"form",ref:D,modelValue:x($),"onUpdate:modelValue":s[4]||(s[4]=e=>h($)?$.value=e:$=e),rules:H,"label-position":"top"},{default:d((()=>[n(l,{class:"refund-item"},{default:d((()=>[n(l,{class:"item-title ss-m-b-20"},{default:d((()=>[f("售后类型")])),_:1}),n(l,{class:"ss-flex-col"},{default:d((()=>[n(g,{onChange:O},{default:d((()=>[(c(!0),p(_,null,m(T.wayList,((e,s)=>(c(),u(w,{class:"ss-flex ss-col-center ss-p-y-10",key:s},{default:d((()=>[n(o,{checked:x($).type===e.value,color:"var(--ui-BG-Main)",style:{transform:"scale(0.8)"},value:e.value},null,8,["checked","value"]),n(l,{class:"item-value ss-m-l-8"},{default:d((()=>[f(y(e.text),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1}),n(l,{class:"refund-item ss-flex ss-col-center ss-row-between",onClick:s[0]||(s[0]=e=>T.showModal=!0)},{default:d((()=>[n(S,{class:"item-title"},{default:d((()=>[f("退款金额")])),_:1}),n(l,{class:"ss-flex refund-cause ss-col-center"},{default:d((()=>[n(S,{class:"ss-m-r-20"},{default:d((()=>[f("￥"+y(x(B)(T.item.payPrice)),1)])),_:1})])),_:1})])),_:1}),n(l,{class:"refund-item ss-flex ss-col-center ss-row-between",onClick:s[1]||(s[1]=e=>T.showModal=!0)},{default:d((()=>[n(S,{class:"item-title"},{default:d((()=>[f("申请原因")])),_:1}),n(l,{class:"ss-flex refund-cause ss-col-center"},{default:d((()=>[x($).applyReason?(c(),u(S,{key:0,class:"ss-m-r-20"},{default:d((()=>[f(y(x($).applyReason),1)])),_:1})):(c(),u(S,{key:1,class:"ss-m-r-20"},{default:d((()=>[f("请选择申请原因~")])),_:1})),n(S,{class:"cicon-forward",style:{height:"28rpx"}})])),_:1})])),_:1}),n(l,{class:"refund-item"},{default:d((()=>[n(l,{class:"item-title ss-m-b-20"},{default:d((()=>[f("相关描述")])),_:1}),n(l,{class:"describe-box"},{default:d((()=>[n(J,{inputBorder:!1,class:"describe-content",type:"textarea",maxlength:"120",autoHeight:"",modelValue:x($).applyDescription,"onUpdate:modelValue":s[2]||(s[2]=e=>x($).applyDescription=e),placeholder:"客官~请描述您遇到的问题，建议上传照片"},null,8,["modelValue"]),n(l,{class:"upload-img"},{default:d((()=>[n(Q,{url:x($).applyPicUrls,"onUpdate:url":s[3]||(s[3]=e=>x($).applyPicUrls=e),fileMediatype:"image",limit:"9",mode:"grid",imageStyles:{width:"168rpx",height:"168rpx"}},null,8,["url"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","rules"]),n(q,{bottom:"",placeholder:""},{default:d((()=>[n(l,{class:"foot-wrap"},{default:d((()=>[n(l,{class:"foot_box ss-flex ss-col-center ss-row-between ss-p-x-30"},{default:d((()=>[n(Z,{class:"ss-reset-button contcat-btn",onClick:s[5]||(s[5]=e=>x(t).$router.go("/pages/chat/index"))},{default:d((()=>[f(" 联系客服 ")])),_:1}),n(Z,{class:"ss-reset-button ui-BG-Main-Gradient sub-btn",onClick:N},{default:d((()=>[f("提交")])),_:1})])),_:1})])),_:1})])),_:1}),n(z,{show:T.showModal,round:"10",showClose:!0,onClose:s[6]||(s[6]=e=>T.showModal=!1)},{default:d((()=>[n(l,{class:"modal-box page_box"},{default:d((()=>[n(l,{class:"modal-head item-title head_box ss-flex ss-row-center ss-col-center"},{default:d((()=>[f(" 申请原因 ")])),_:1}),n(l,{class:"modal-content content_box"},{default:d((()=>[n(g,{onChange:A},{default:d((()=>[(c(!0),p(_,null,m(T.reasonList,(e=>(c(),u(w,{class:"radio ss-flex ss-col-center",key:e},{default:d((()=>[n(l,{class:"ss-flex-1 ss-p-20"},{default:d((()=>[f(y(e),1)])),_:2},1024),n(o,{value:e,color:"var(--ui-BG-Main)",checked:e===T.currentValue},null,8,["value","checked"])])),_:2},1024)))),128))])),_:1})])),_:1}),n(l,{class:"modal-foot foot_box ss-flex ss-row-center ss-col-center"},{default:d((()=>[n(Z,{class:"ss-reset-button close-btn ui-BG-Main-Gradient",onClick:F},{default:d((()=>[f(" 确定 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}}},[["__scopeId","data-v-26fa1214"]]);export{D as default};
