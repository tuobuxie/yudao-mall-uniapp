import{v as a,o as t,aE as s,r as e,e as o,f as n,w as l,aP as i,j as r,k as u,g as c,l as p,m as d,F as f,aF as m,i as g,u as _,s as y,p as b,t as x,D as k,P as v,G as w,H as j}from"./index-kPUodEo8.js";import{_ as S}from"./su-tabs.BcL6QNZj.js";import{_ as h}from"./su-sticky.B6SSP8sh.js";import{_ as C}from"./s-empty.B9iGK6-f.js";import{_ as T}from"./s-goods-item.nGp3A0wy.js";import{_ as N}from"./uni-load-more.8Kzkyk-l.js";import{S as P}from"./s-layout.ChN2kRO2.js";import{p as z,q as A,r as E}from"./useGoods.CNv-03RG.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{c as G}from"./concat.CXHZS4ws.js";const M=F({__name:"list",setup(F){const M=a({currentTab:0,showApply:!1,pagination:{list:[],total:0,pageNo:1,pageSize:10},loadStatus:""}),q=[{name:"全部",value:[]},{name:"申请中",value:[10]},{name:"处理中",value:[20,30,40]},{name:"已完成",value:[50]},{name:"已拒绝",value:[61,62,63]}];function D(a){m(M.pagination),M.currentTab=a.index,H()}async function H(){M.loadStatus="loading";let{data:a,code:t}=await i.getAfterSalePage({pageNo:M.pagination.pageNo,pageSize:M.pagination.pageSize,statuses:q[M.currentTab].value.join(",")});0===t&&(a.list.forEach((a=>z(a))),M.pagination.list=G(M.pagination.list,a.list),M.pagination.total=a.total,M.loadStatus=M.pagination.list.length<M.pagination.total?"more":"noMore")}function I(){"noMore"!==M.loadStatus&&(M.pagination.pageNo++,H())}return t((async a=>{a.type&&(M.currentTab=a.type),await H()})),s((()=>{I()})),(a,t)=>{const s=e(o("su-tabs"),S),z=e(o("su-sticky"),h),F=e(o("s-empty"),C),G=w,U=g,Z=e(o("s-goods-item"),T),$=j,B=e(o("uni-load-more"),N),J=e(o("s-layout"),P);return r(),n(J,{title:"售后列表"},{default:l((()=>[u(z,{bgColor:"#fff"},{default:l((()=>[u(s,{list:q,scrollable:!1,onChange:D,current:M.currentTab},null,8,["current"])])),_:1}),0===M.pagination.total?(r(),n(F,{key:0,icon:"/static/data-empty.png",text:"暂无数据"})):c("",!0),M.pagination.total>0?(r(),n(U,{key:1},{default:l((()=>[(r(!0),p(f,null,d(M.pagination.list,(a=>(r(),n(U,{class:"list-box ss-m-y-20",key:a.id,onClick:t=>_(y).$router.go("/pages/order/aftersale/detail",{id:a.id})},{default:l((()=>[u(U,{class:"order-head ss-flex ss-col-center ss-row-between"},{default:l((()=>[u(G,{class:"no"},{default:l((()=>[b("服务单号："+x(a.no),1)])),_:2},1024),u(G,{class:"state"},{default:l((()=>[b(x(_(A)(a)),1)])),_:2},1024)])),_:2},1024),u(Z,{img:a.picUrl,title:a.spuName,skuText:a.properties.map((a=>a.valueName)).join(" "),price:a.refundPrice},null,8,["img","title","skuText","price"]),u(U,{class:"apply-box ss-flex ss-col-center ss-row-between border-bottom ss-p-x-20"},{default:l((()=>[u(U,{class:"ss-flex ss-col-center"},{default:l((()=>[u(U,{class:"title ss-m-r-20"},{default:l((()=>[b(x(10===a.way?"仅退款":"退款退货"),1)])),_:2},1024),u(U,{class:"value"},{default:l((()=>[b(x(_(E)(a)),1)])),_:2},1024)])),_:2},1024),u(G,{class:"_icon-forward"})])),_:2},1024),u(U,{class:"tool-btn-box ss-flex ss-col-center ss-row-right ss-p-r-20"},{default:l((()=>[u(U,null,{default:l((()=>[(null==a?void 0:a.buttons.includes("cancel"))?(r(),n($,{key:0,class:"ss-reset-button tool-btn",onClick:k((t=>{return s=a.id,void v({title:"提示",content:"确定要取消此申请吗？",success:async function(a){if(!a.confirm)return;const{code:t}=await i.cancelAfterSale(s);0===t&&(m(M.pagination),await H())}});var s}),["stop"])},{default:l((()=>[b(" 取消申请 ")])),_:2},1032,["onClick"])):c("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):c("",!0),M.pagination.total>0?(r(),n(B,{key:2,status:M.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:I},null,8,["status"])):c("",!0)])),_:1})}}},[["__scopeId","data-v-51009882"]]);export{M as default};
