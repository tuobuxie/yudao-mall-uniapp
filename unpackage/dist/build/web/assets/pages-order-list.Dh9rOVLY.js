import{v as t,o as s,aE as a,a as e,aF as o,b as n,r as i,e as l,f as r,w as c,a4 as u,j as d,k as p,g as f,l as m,m as g,F as b,i as y,p as k,t as _,A as x,u as C,D as v,s as w,an as h,P as j,H as S}from"./index-kPUodEo8.js";import{_ as T}from"./su-tabs.BcL6QNZj.js";import{_ as N}from"./su-sticky.B6SSP8sh.js";import{_ as $}from"./s-empty.B9iGK6-f.js";import{_ as I}from"./s-goods-item.nGp3A0wy.js";import{_ as O}from"./uni-load-more.8Kzkyk-l.js";import{S as M}from"./s-layout.ChN2kRO2.js";import{l as P,o as z,m as G,f as E}from"./useGoods.CNv-03RG.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{c as A}from"./concat.CXHZS4ws.js";const B=F({__name:"list",setup(F){const B=t({currentTab:0,pagination:{list:[],total:0,pageNo:1,pageSize:5},loadStatus:""}),D=[{name:"全部"},{name:"待付款",value:0},{name:"待发货",value:10},{name:"待收货",value:20},{name:"待评价",value:30}];function H(t){B.currentTab!==t.index&&(o(B.pagination),B.currentTab=t.index,U())}function R(t){w.$router.go("/pages/order/detail",{id:t})}async function U(){B.loadStatus="loading";let{code:t,data:s}=await u.getOrderPage({pageNo:B.pagination.pageNo,pageSize:B.pagination.pageSize,status:D[B.currentTab].value,commentStatus:30!==D[B.currentTab].value&&null});0===t&&(s.list.forEach((t=>P(t))),B.pagination.list=A(B.pagination.list,s.list),B.pagination.total=s.total,B.loadStatus=B.pagination.list.length<B.pagination.total?"more":"noMore")}function W(){"noMore"!==B.loadStatus&&(B.pagination.pageNo++,U())}return s((async t=>{t.type&&(B.currentTab=t.type),await U()})),a((()=>{W()})),e((()=>{o(B.pagination),U(),setTimeout((function(){n()}),800)})),(t,s)=>{const a=i(l("su-tabs"),T),e=i(l("su-sticky"),N),n=i(l("s-empty"),$),F=y,A=i(l("s-goods-item"),I),Z=S,q=i(l("uni-load-more"),O),J=i(l("s-layout"),M);return d(),r(J,{title:"我的订单"},{default:c((()=>[p(e,{bgColor:"#fff"},{default:c((()=>[p(a,{list:D,scrollable:!1,onChange:H,current:B.currentTab},null,8,["current"])])),_:1}),0===B.pagination.total?(d(),r(n,{key:0,icon:"/static/order-empty.png",text:"暂无订单"})):f("",!0),B.pagination.total>0?(d(),r(F,{key:1},{default:c((()=>[(d(!0),m(b,null,g(B.pagination.list,(t=>(d(),r(F,{class:"bg-white order-list-card-box ss-r-10 ss-m-t-14 ss-m-20",key:t.id,onClick:s=>R(t.id)},{default:c((()=>[p(F,{class:"order-card-header ss-flex ss-col-center ss-row-between ss-p-x-20"},{default:c((()=>[p(F,{class:"order-no"},{default:c((()=>[k("订单号："+_(t.no),1)])),_:2},1024),p(F,{class:x(["order-state ss-font-26",C(z)(t)])},{default:c((()=>[k(_(C(G)(t)),1)])),_:2},1032,["class"])])),_:2},1024),(d(!0),m(b,null,g(t.items,(t=>(d(),r(F,{class:"border-bottom",key:t.id},{default:c((()=>[p(A,{img:t.picUrl,title:t.spuName,skuText:t.properties.map((t=>t.valueName)).join(" "),price:t.price,num:t.count},null,8,["img","title","skuText","price","num"])])),_:2},1024)))),128)),p(F,{class:"pay-box ss-m-t-30 ss-flex ss-row-right ss-p-r-20"},{default:c((()=>[p(F,{class:"ss-flex ss-col-center"},{default:c((()=>[p(F,{class:"discounts-title pay-color"},{default:c((()=>[k("共 "+_(t.productCount)+" 件商品,总金额:",1)])),_:2},1024),p(F,{class:"discounts-money pay-color"},{default:c((()=>[k(" ￥"+_(C(E)(t.payPrice)),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),p(F,{class:x(["order-card-footer ss-flex ss-col-center ss-p-x-20",t.buttons.length>3?"ss-row-between":"ss-row-right"])},{default:c((()=>[p(F,{class:"ss-flex ss-col-center"},{default:c((()=>[t.buttons.includes("combination")?(d(),r(Z,{key:0,class:"tool-btn ss-reset-button",onClick:v((s=>function(t){w.$router.go("/pages/activity/groupon/detail",{id:t.combinationRecordId})}(t)),["stop"])},{default:c((()=>[k(" 拼团详情 ")])),_:2},1032,["onClick"])):f("",!0),0===t.buttons.length?(d(),r(Z,{key:1,class:"tool-btn ss-reset-button",onClick:v((s=>R(t.id)),["stop"])},{default:c((()=>[k(" 查看详情 ")])),_:2},1032,["onClick"])):f("",!0),t.buttons.includes("confirm")?(d(),r(Z,{key:2,class:"tool-btn ss-reset-button",onClick:v((s=>async function(t,s=!1){"WechatMiniProgram"!==w.$platform.name||h(t.wechat_extra_data)||s?j({title:"提示",content:"确认收货吗？",success:async function(s){if(!s.confirm)return;const{code:a}=await u.receiveOrder(t.id);0===a&&(o(B.pagination),await U())}}):mpConfirm(t)}(t)),["stop"])},{default:c((()=>[k(" 确认收货 ")])),_:2},1032,["onClick"])):f("",!0),t.buttons.includes("express")?(d(),r(Z,{key:3,class:"tool-btn ss-reset-button",onClick:v((s=>async function(t){w.$router.go("/pages/order/express/log",{id:t})}(t.id)),["stop"])},{default:c((()=>[k(" 查看物流 ")])),_:2},1032,["onClick"])):f("",!0),t.buttons.includes("cancel")?(d(),r(Z,{key:4,class:"tool-btn ss-reset-button",onClick:v((s=>async function(t){j({title:"提示",content:"确定要取消订单吗?",success:async function(s){if(!s.confirm)return;const{code:a}=await u.cancelOrder(t);if(0===a){let s=B.pagination.list.findIndex((s=>s.id===t));const a=B.pagination.list[s];a.status=40,P(a)}}})}(t.id)),["stop"])},{default:c((()=>[k(" 取消订单 ")])),_:2},1032,["onClick"])):f("",!0),t.buttons.includes("comment")?(d(),r(Z,{key:5,class:"tool-btn ss-reset-button",onClick:v((s=>{return a=t.id,void w.$router.go("/pages/goods/comment/add",{id:a});var a}),["stop"])},{default:c((()=>[k(" 评价 ")])),_:2},1032,["onClick"])):f("",!0),t.buttons.includes("delete")?(d(),r(Z,{key:6,class:"delete-btn ss-reset-button",onClick:v((s=>{return a=t.id,void j({title:"提示",content:"确定要删除订单吗?",success:async function(t){if(t.confirm){const{code:t}=await u.deleteOrder(a);if(0===t){let t=B.pagination.list.findIndex((t=>t.id===a));B.pagination.list.splice(t,1)}}}});var a}),["stop"])},{default:c((()=>[k(" 删除订单 ")])),_:2},1032,["onClick"])):f("",!0),t.buttons.includes("pay")?(d(),r(Z,{key:7,class:"tool-btn ss-reset-button ui-BG-Main-Gradient",onClick:v((s=>{return a=t.payOrderId,void w.$router.go("/pages/pay/index",{id:a});var a}),["stop"])},{default:c((()=>[k(" 继续支付 ")])),_:2},1032,["onClick"])):f("",!0)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1032,["onClick"])))),128))])),_:1})):f("",!0),B.pagination.total>0?(d(),r(q,{key:2,status:B.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:W},null,8,["status"])):f("",!0)])),_:1})}}},[["__scopeId","data-v-402a3828"]]);export{B as default};
