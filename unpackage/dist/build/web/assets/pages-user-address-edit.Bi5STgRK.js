import{j as e,f as a,w as l,k as t,A as o,i as n,y as s,p as r,t as i,g as d,D as c,G as u,L as m,v as f,c as p,r as _,e as h,l as y,F as b,m as g,u as x,b2 as v,b3 as w,X as B,o as S,a$ as C,an as k,b0 as V,O as I,s as T,P as A,H as N}from"./index-kPUodEo8.js";import{c as z,g as $,j,b as U,i as M,_ as R,S as D,m as P}from"./s-layout.ChN2kRO2.js";import{_ as q}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F={name:"UiSwitch"},G=q(Object.assign(F,{props:{modelValue:{type:[Boolean,Number],default:!1},ui:{type:String,default:""},bg:{type:String,default:"ui-BG-Main"},text:{type:String,default:""},size:{type:String,default:"sm"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:r}){const i=s,d=r,c=()=>{d("update:modelValue",!i.modelValue)};return(s,r)=>{const d=n;return e(),a(d,{class:o(["ui-switch",[{disabled:i.disabled},i.ui]])},{default:l((()=>[t(d,{class:"ui-switch-wrapper",onClick:c},{default:l((()=>[t(d,{class:o(["ui-switch-input",[{"ui-switch-input-checked":i.modelValue},i.modelValue?i.bg:"",i.text,i.size]])},null,8,["class"])])),_:1})])),_:1},8,["class"])}}}),[["__scopeId","data-v-fc892ff3"]]);const O=q({name:"SuToolbar",props:{show:{type:Boolean,default:!0},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"},title:{type:String,default:""}},methods:{cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")},preventEvent(e){e&&"function"==typeof e.stopPropagation&&e.stopPropagation()},noop(e){this.preventEvent(e)}}},[["render",function(o,m,f,p,_,h){const y=u,b=n;return f.show?(e(),a(b,{key:0,class:"u-toolbar",onTouchmove:c(h.noop,["stop","prevent"])},{default:l((()=>[t(b,{class:"u-toolbar__cancel__wrapper","hover-class":"u-hover-class"},{default:l((()=>[t(y,{class:"u-toolbar__wrapper__cancel",onClick:h.cancel,style:s({color:f.cancelColor})},{default:l((()=>[r(i(f.cancelText),1)])),_:1},8,["onClick","style"])])),_:1}),f.title?(e(),a(y,{key:0,class:"u-toolbar__title u-line-1"},{default:l((()=>[r(i(f.title),1)])),_:1})):d("",!0),t(b,{class:"u-toolbar__confirm__wrapper","hover-class":"u-hover-class"},{default:l((()=>[t(y,{class:"u-toolbar__wrapper__confirm",onClick:h.confirm,style:s({color:f.confirmColor})},{default:l((()=>[r(i(f.confirmText),1)])),_:1},8,["onClick","style"])])),_:1})])),_:1},8,["onTouchmove"])):d("",!0)}],["__scopeId","data-v-1a1af626"]]),E=q({__name:"su-region-picker",props:{show:{type:Boolean,default:!1},cancelColor:{type:String,default:"#6666"},confirmColor:{type:String,default:"var(--ui-BG-Main)"},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"}},emits:["confirm","cancel","change"],setup(o,{emit:d}){const c=m("areaData"),u=e=>{let a=e.length;return a<=7?"":a<9?"font-size:28rpx":"font-size: 24rpx"},B=f({currentIndex:[0,0,0],moving:!1}),S=d,C=c,k=p((()=>c[B.currentIndex[0]].children)),V=p((()=>{var e;return null==(e=k.value[B.currentIndex[1]])?void 0:e.children})),I=()=>{},T=()=>{},A=()=>{S("cancel")},N=e=>{B.currentIndex[0]!==e.detail.value[0]||B.currentIndex[1]!==e.detail.value[1]?(B.currentIndex[0]!==e.detail.value[0]&&(e.detail.value[1]=0),e.detail.value[2]=0,B.currentIndex=e.detail.value,S("change",B.currentIndex)):B.currentIndex[2]=e.detail.value[2]};return(d,c)=>{const m=_(h("su-toolbar"),O),f=n,p=v,$=w,j=_(h("su-popup"),z);return e(),a(j,{show:o.show,onClose:A,round:"20"},{default:l((()=>[t(f,{class:"ui-region-picker"},{default:l((()=>[t(m,{cancelColor:o.cancelColor,confirmColor:o.confirmColor,cancelText:o.cancelText,confirmText:o.confirmText,title:"选择区域",onCancel:A,onConfirm:c[0]||(c[0]=e=>((e=null)=>{let a=B.currentIndex,l=C[a[0]],t=k.value[a[1]],o=V.value[a[2]],n={province_name:l.name,province_id:l.id,city_name:t.name,city_id:t.id,district_name:o.name,district_id:o.id};e&&S(e,n)})("confirm"))},null,8,["cancelColor","confirmColor","cancelText","confirmText"]),t(f,{class:"ui-picker-body"},{default:l((()=>[t($,{value:B.currentIndex,onChange:N,class:"ui-picker-view",onPickstart:I,onPickend:T},{default:l((()=>[t(p,null,{default:l((()=>[(e(!0),y(b,null,g(x(C),(o=>(e(),a(f,{class:"ui-column-item",key:o.id},{default:l((()=>[t(f,{style:s(u(o.name))},{default:l((()=>[r(i(o.name),1)])),_:2},1032,["style"])])),_:2},1024)))),128))])),_:1}),t(p,null,{default:l((()=>[(e(!0),y(b,null,g(k.value,(o=>(e(),a(f,{class:"ui-column-item",key:o.id},{default:l((()=>[t(f,{style:s(u(o.name))},{default:l((()=>[r(i(o.name),1)])),_:2},1032,["style"])])),_:2},1024)))),128))])),_:1}),t(p,null,{default:l((()=>[(e(!0),y(b,null,g(V.value,(o=>(e(),a(f,{class:"ui-column-item",key:o.id},{default:l((()=>[t(f,{style:s(u(o.name))},{default:l((()=>[r(i(o.name),1)])),_:2},1032,["style"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["value"])])),_:1})])),_:1})])),_:1},8,["show"])}}},[["__scopeId","data-v-516f9464"]]),H=q({__name:"edit",setup(o){const s=B(null),i=f({showRegion:!1,model:{name:"",mobile:"",detailAddress:"",defaultStatus:!1,areaName:""},rules:{}}),c={name:{rules:[{required:!0,errorMessage:"请输入收货人姓名"}]},mobile:P,detailAddress:{rules:[{required:!0,errorMessage:"请输入详细地址"}]},areaName:{rules:[{required:!0,errorMessage:"请选择您的位置"}]}},u=e=>{i.model.areaName=`${e.province_name} ${e.city_name} ${e.district_name}`,i.model.areaId=e.district_id,i.showRegion=!1},p=async()=>{if(!(await x(s).validate().catch((e=>{console.log("error: ",e)}))))return;const e={...i.model},{code:a}=i.model.id>0?await C.updateAddress(e):await C.createAddress(e);0===a&&T.$router.back()},y=()=>{A({title:"提示",content:"确认删除此收货地址吗？",success:async function(e){if(!e.confirm)return;const{code:a}=await C.deleteAddress(i.model.id);0===a&&T.$router.back()}})};return S((async e=>{if(k(m("areaData"))&&V.getAreaTree().then((e=>{0===e.code&&I("areaData",e.data)})),e.id){let{code:a,data:l}=await C.getAddress(e.id);if(0!==a)return;i.model=l}if(e.data){let a=JSON.parse(e.data);const l=(e,a)=>e.find((e=>e.name===a));let t=l(m("areaData"),a.province_name),o=t?l(t.children,a.city_name):void 0,n=((o?l(o.children,a.district_name):void 0)||o||t).id;i.model={...i.model,areaId:n,areaName:[a.province_name,a.city_name,a.district_name].filter(Boolean).join(" "),defaultStatus:!1,detailAddress:a.address,mobile:a.mobile,name:a.consignee}}})),(o,m)=>{const f=_(h("uni-easyinput"),$),b=_(h("uni-forms-item"),j),g=_(h("uni-icons"),U),x=n,v=_(h("su-switch"),G),w=_(h("uni-forms"),M),B=N,S=_(h("su-fixed"),R),C=_(h("su-region-picker"),E),k=_(h("s-layout"),D);return e(),a(k,{title:i.model.id?"编辑地址":"新增地址"},{default:l((()=>[t(w,{ref_key:"addressFormRef",ref:s,modelValue:i.model,"onUpdate:modelValue":m[6]||(m[6]=e=>i.model=e),rules:c,validateTrigger:"bind",labelWidth:"160",labelAlign:"left",border:"",labelStyle:{fontWeight:"bold"}},{default:l((()=>[t(x,{class:"bg-white form-box ss-p-x-30"},{default:l((()=>[t(b,{name:"name",label:"收货人",class:"form-item"},{default:l((()=>[t(f,{modelValue:i.model.name,"onUpdate:modelValue":m[0]||(m[0]=e=>i.model.name=e),placeholder:"请填写收货人姓名",inputBorder:!1,placeholderStyle:"color:#BBBBBB;font-size:30rpx;font-weight:400;line-height:normal"},null,8,["modelValue"])])),_:1}),t(b,{name:"mobile",label:"手机号",class:"form-item"},{default:l((()=>[t(f,{modelValue:i.model.mobile,"onUpdate:modelValue":m[1]||(m[1]=e=>i.model.mobile=e),type:"number",placeholder:"请输入手机号",inputBorder:!1,placeholderStyle:"color:#BBBBBB;font-size:30rpx;font-weight:400;line-height:normal"},null,8,["modelValue"])])),_:1}),t(b,{name:"areaName",label:"省市区",onClick:m[3]||(m[3]=e=>i.showRegion=!0),class:"form-item"},{default:l((()=>[t(f,{modelValue:i.model.areaName,"onUpdate:modelValue":m[2]||(m[2]=e=>i.model.areaName=e),disabled:"",inputBorder:!1,styles:{disableColor:"#fff",color:"#333"},placeholderStyle:"color:#BBBBBB;font-size:30rpx;font-weight:400;line-height:normal",placeholder:"请选择省市区"},{right:l((()=>[t(g,{type:"right"})])),_:1},8,["modelValue"])])),_:1}),t(b,{name:"detailAddress",label:"详细地址",formItemStyle:{alignItems:"flex-start"},labelStyle:{lineHeight:"5em"},class:"textarea-item"},{default:l((()=>[t(f,{inputBorder:!1,type:"textarea",modelValue:i.model.detailAddress,"onUpdate:modelValue":m[4]||(m[4]=e=>i.model.detailAddress=e),placeholderStyle:"color:#BBBBBB;font-size:30rpx;font-weight:400;line-height:normal",placeholder:"请输入详细地址",clearable:""},null,8,["modelValue"])])),_:1})])),_:1}),t(x,{class:"ss-m-y-20 bg-white ss-p-x-30 ss-flex ss-row-between ss-col-center default-box"},{default:l((()=>[t(x,{class:"default-box-title"},{default:l((()=>[r(" 设为默认地址 ")])),_:1}),t(v,{style:{transform:"scale(0.8)"},modelValue:i.model.defaultStatus,"onUpdate:modelValue":m[5]||(m[5]=e=>i.model.defaultStatus=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["modelValue"]),t(S,{bottom:"",opacity:!1,bg:"",placeholder:"",noFixed:!1,index:10},{default:l((()=>[t(x,{class:"footer-box ss-flex-col ss-row-between ss-p-20"},{default:l((()=>[t(x,{class:"ss-m-b-20"},{default:l((()=>[t(B,{class:"ss-reset-button save-btn ui-Shadow-Main",onClick:p},{default:l((()=>[r("保存")])),_:1})])),_:1}),i.model.id?(e(),a(B,{key:0,class:"ss-reset-button cancel-btn",onClick:y},{default:l((()=>[r(" 删除 ")])),_:1})):d("",!0)])),_:1})])),_:1}),t(C,{show:i.showRegion,onCancel:m[7]||(m[7]=e=>i.showRegion=!1),onConfirm:u},null,8,["show"])])),_:1},8,["title"])}}},[["__scopeId","data-v-89beec2f"]]);export{H as default};
