import{B as e,s as t,v as s,aE as a,o as l,r as o,e as i,f as c,w as n,u as d,ak as r,j as u,k as p,p as f,t as g,g as m,l as _,m as C,F as k,at as x,au as h,D as b,aF as y,G as M,i as w,H as L,I as S,J as j}from"./index-Ch_jkemp.js";import{_ as v}from"./s-goods-item.DcngbUKh.js";import{_ as A,S as I}from"./s-layout.Ckk_oEQ_.js";import{_ as F}from"./uni-load-more.C8hvkNiT.js";import{_ as G}from"./s-empty.DdU54__M.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{c as B}from"./concat.B-rUqbX7.js";import"./useGoods.CmR2wUi_.js";const z=N({__name:"goods-collect",setup(N){e((e=>({"7fd33b8a":d(z)})));const z=t.$platform.navbar,T=s({pagination:{list:[],total:0,pageNo:1,pageSize:6},loadStatus:"",editMode:!1,selectedCollectList:[],selectAll:!1});async function $(){T.loadStatus="loading";const{code:e,data:t}=await r.getFavoritePage({pageNo:T.pagination.pageNo,pageSize:T.pagination.pageSize});0===e&&(T.pagination.list=B(T.pagination.list,t.list),T.pagination.total=t.total,T.loadStatus=T.pagination.list.length<T.pagination.total?"more":"noMore")}const D=e=>{T.selectedCollectList.includes(e)?T.selectedCollectList.splice(T.selectedCollectList.indexOf(e),1):T.selectedCollectList.push(e),T.selectAll=T.selectedCollectList.length===T.pagination.list.length},E=()=>{T.selectAll=!T.selectAll,T.selectAll?T.selectedCollectList=T.pagination.list.map((e=>e.spuId)):T.selectedCollectList=[]};async function H(){if(T.selectedCollectList){for(const e of T.selectedCollectList)await r.deleteFavorite(e);T.editMode=!1,T.selectedCollectList=[],T.selectAll=!1,y(T.pagination),await $()}}function J(){"noMore"!==T.loadStatus&&(T.pagination.pageNo++,$())}return a((()=>{J()})),l((()=>{$()})),(e,s)=>{const a=M,l=w,r=L,y=S,N=j,B=o(i("s-goods-item"),v),z=o(i("su-fixed"),A),$=o(i("uni-load-more"),F),O=o(i("s-empty"),G),P=o(i("s-layout"),I);return u(),c(P,{title:"商品收藏"},{default:n((()=>[p(l,{class:"cart-box ss-flex ss-flex-col ss-row-between"},{default:n((()=>[p(l,{class:"cart-header ss-flex ss-col-center ss-row-between ss-p-x-30"},{default:n((()=>[p(l,{class:"header-left ss-flex ss-col-center ss-font-26"},{default:n((()=>[f(" 共 "),p(a,{class:"goods-number ui-TC-Main ss-flex"},{default:n((()=>[f(g(T.pagination.total),1)])),_:1}),f(" 件商品 ")])),_:1}),p(l,{class:"header-right"},{default:n((()=>[T.editMode&&T.pagination.total?(u(),c(r,{key:0,class:"ss-reset-button",onClick:s[0]||(s[0]=e=>T.editMode=!1)},{default:n((()=>[f(" 取消 ")])),_:1})):m("",!0),!T.editMode&&T.pagination.total?(u(),c(r,{key:1,class:"ss-reset-button ui-TC-Main",onClick:s[1]||(s[1]=e=>T.editMode=!0)},{default:n((()=>[f(" 编辑 ")])),_:1})):m("",!0)])),_:1})])),_:1}),p(l,{class:"cart-content"},{default:n((()=>[(u(!0),_(k,null,C(T.pagination.list,(e=>(u(),c(l,{class:"goods-box ss-r-10 ss-m-b-14",key:e.id},{default:n((()=>[p(l,{class:"ss-flex ss-col-center"},{default:n((()=>[T.editMode?(u(),c(N,{key:0,class:"check-box ss-flex ss-col-center ss-p-l-10",onClick:t=>D(e.spuId)},{default:n((()=>[p(y,{checked:T.selectedCollectList.includes(e.spuId),color:"var(--ui-BG-Main)",style:{transform:"scale(0.8)"},onClick:b((t=>D(e.spuId)),["stop"])},null,8,["checked","onClick"])])),_:2},1032,["onClick"])):m("",!0),p(B,{title:e.spuName,img:e.picUrl,price:e.price,priceColor:"#FF3000",titleWidth:400,onClick:s=>d(t).$router.go("/pages/goods/index",{id:e.spuId})},null,8,["title","img","price","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),x(p(z,{bottom:"",val:0,placeholder:""},{default:n((()=>[p(l,{class:"cart-footer ss-flex ss-col-center ss-row-between ss-p-x-30 border-bottom"},{default:n((()=>[p(l,{class:"footer-left ss-flex ss-col-center"},{default:n((()=>[p(N,{class:"check-box ss-flex ss-col-center ss-p-r-30",onClick:E},{default:n((()=>[p(y,{checked:T.selectAll,color:"var(--ui-BG-Main)",style:{transform:"scale(0.7)"},onClick:b(E,["stop"])},null,8,["checked"]),p(l,null,{default:n((()=>[f(" 全选 ")])),_:1})])),_:1})])),_:1}),p(l,{class:"footer-right"},{default:n((()=>[p(r,{class:"ss-reset-button ui-BG-Main-Gradient pay-btn ss-font-28 ui-Shadow-Main",onClick:H},{default:n((()=>[f(" 取消收藏 ")])),_:1})])),_:1})])),_:1})])),_:1},512),[[h,T.editMode]])])),_:1}),T.pagination.total>0?(u(),c($,{key:0,status:T.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:J},null,8,["status"])):m("",!0),0===T.pagination.total?(u(),c(O,{key:1,text:"暂无收藏",icon:"/static/collect-empty.png"})):m("",!0)])),_:1})}}},[["__scopeId","data-v-7cc42e2e"]]);export{z as default};
