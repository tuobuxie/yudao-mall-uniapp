import{B as s,s as e,v as t,aZ as a,aE as l,o,r as i,e as n,f as c,w as d,u,a_ as r,j as p,k as f,p as g,t as m,g as _,l as S,m as k,F as x,at as I,au as h,D as b,A as y,G as M,i as L,H as w,I as C,J as j}from"./index-kPUodEo8.js";import{_ as A}from"./s-goods-item.nGp3A0wy.js";import{_ as B,S as G}from"./s-layout.ChN2kRO2.js";import{_ as v}from"./uni-load-more.8Kzkyk-l.js";import{_ as N}from"./s-empty.B9iGK6-f.js";import{_ as H}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{c as T}from"./concat.CXHZS4ws.js";import"./useGoods.CNv-03RG.js";const z=H({__name:"goods-log",setup(H){s((s=>({"9b3834b2":u(z)})));const z=e.$platform.navbar,F={list:[],pageNo:1,total:1,pageSize:10},E=t({pagination:a(F),loadStatus:"",editMode:!1,selectedSpuIdList:[],selectAll:!1});async function O(){E.loadStatus="loading";const{code:s,data:e}=await r.getBrowseHistoryPage({pageNo:E.pagination.pageNo,pageSize:E.pagination.pageSize});0===s&&(E.pagination.list=T(E.pagination.list,e.list),E.pagination.total=e.total,E.loadStatus=E.pagination.list.length<E.pagination.total?"more":"noMore")}const Z=s=>{E.selectedSpuIdList.includes(s)?E.selectedSpuIdList.splice(E.selectedSpuIdList.indexOf(s),1):E.selectedSpuIdList.push(s),E.selectAll=E.selectedSpuIdList.length===E.pagination.list.length},$=()=>{E.selectAll=!E.selectAll,E.selectAll?E.pagination.list.forEach((s=>{E.selectedSpuIdList.includes(s.spuId)&&E.selectedSpuIdList.splice(E.selectedSpuIdList.indexOf(s.spuId),1),E.selectedSpuIdList.push(s.spuId)})):E.selectedSpuIdList=[]};async function D(){if(E.selectedSpuIdList.length<=0)return;const{code:s}=await r.deleteBrowseHistory(E.selectedSpuIdList);0===s&&P()}async function J(){const{code:s}=await r.cleanBrowseHistory();0===s&&P()}function P(){E.editMode=!1,E.selectedSpuIdList=[],E.selectAll=!1,E.pagination=F,O()}function U(){"noMore"!==E.loadStatus&&(E.pagination.pageNo+=1,O())}return l((()=>{U()})),o((()=>{O()})),(s,t)=>{const a=M,l=L,o=w,r=C,H=j,T=i(n("s-goods-item"),A),z=i(n("su-fixed"),B),F=i(n("uni-load-more"),v),O=i(n("s-empty"),N),P=i(n("s-layout"),G);return p(),c(P,{bgStyle:{color:"#f2f2f2"},title:"我的足迹"},{default:d((()=>[f(l,{class:"cart-box ss-flex ss-flex-col ss-row-between"},{default:d((()=>[f(l,{class:"cart-header ss-flex ss-col-center ss-row-between ss-p-x-30"},{default:d((()=>[f(l,{class:"header-left ss-flex ss-col-center ss-font-26"},{default:d((()=>[g(" 共 "),f(a,{class:"goods-number ui-TC-Main ss-flex"},{default:d((()=>[g(m(E.pagination.total),1)])),_:1}),g(" 件商品 ")])),_:1}),f(l,{class:"header-right"},{default:d((()=>[E.editMode&&E.pagination.total?(p(),c(o,{key:0,class:"ss-reset-button",onClick:t[0]||(t[0]=s=>E.editMode=!1)},{default:d((()=>[g(" 取消 ")])),_:1})):_("",!0),!E.editMode&&E.pagination.total?(p(),c(o,{key:1,class:"ss-reset-button ui-TC-Main",onClick:t[1]||(t[1]=s=>E.editMode=!0)},{default:d((()=>[g(" 编辑 ")])),_:1})):_("",!0)])),_:1})])),_:1}),f(l,{class:"cart-content"},{default:d((()=>[(p(!0),S(x,null,k(E.pagination.list,(s=>(p(),c(l,{class:"goods-box ss-r-10 ss-m-b-14",key:s.id},{default:d((()=>[f(l,{class:"ss-flex ss-col-center"},{default:d((()=>[E.editMode?(p(),c(H,{key:0,class:"check-box ss-flex ss-col-center ss-p-l-10",onClick:e=>Z(s.spuId)},{default:d((()=>[f(r,{checked:E.selectedSpuIdList.includes(s.spuId),color:"var(--ui-BG-Main)",style:{transform:"scale(0.8)"},onClick:b((e=>Z(s.spuId)),["stop"])},null,8,["checked","onClick"])])),_:2},1032,["onClick"])):_("",!0),f(T,{title:s.spuName,img:s.picUrl,price:s.price,skuText:s.introduction,priceColor:"#FF3000",titleWidth:400,onClick:t=>u(e).$router.go("/pages/goods/index",{id:s.spuId})},null,8,["title","img","price","skuText","onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),I(f(z,{bottom:"",val:0,placeholder:""},{default:d((()=>[f(l,{class:"cart-footer ss-flex ss-col-center ss-row-between ss-p-x-30 border-bottom"},{default:d((()=>[f(l,{class:"footer-left ss-flex ss-col-center"},{default:d((()=>[f(H,{class:"check-box ss-flex ss-col-center ss-p-r-30",onClick:$},{default:d((()=>[f(r,{checked:E.selectAll,color:"var(--ui-BG-Main)",style:{transform:"scale(0.7)"},onClick:b($,["stop"])},null,8,["checked"]),f(l,null,{default:d((()=>[g("全选")])),_:1})])),_:1})])),_:1}),f(l,{class:"footer-right ss-flex"},{default:d((()=>[f(o,{class:y(["ss-reset-button  pay-btn ss-font-28 ",{"ui-BG-Main-Gradient":E.selectedSpuIdList.length>0,"ui-Shadow-Main":E.selectedSpuIdList.length>0}]),onClick:D},{default:d((()=>[g(" 删除足迹 ")])),_:1},8,["class"]),f(o,{class:"ss-reset-button ui-BG-Main-Gradient pay-btn ss-font-28 ui-Shadow-Main ml-2",onClick:J},{default:d((()=>[g(" 清空 ")])),_:1})])),_:1})])),_:1})])),_:1},512),[[h,E.editMode]])])),_:1}),E.pagination.total>0?(p(),c(F,{key:0,status:E.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:U},null,8,["status"])):_("",!0),0===E.pagination.total?(p(),c(O,{key:1,text:"暂无浏览记录",icon:"/static/collect-empty.png"})):_("",!0)])),_:1})}}},[["__scopeId","data-v-9db1670d"]]);export{z as default};
