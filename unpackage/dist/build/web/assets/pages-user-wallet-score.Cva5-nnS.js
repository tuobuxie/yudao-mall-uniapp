import{s as a,c as t,v as e,o as s,b5 as o,aE as l,r as n,e as i,f as r,w as d,b7 as u,j as c,k as p,p as m,t as f,y as g,u as _,l as y,m as b,F as x,g as v,aF as h,i as k,G as w,H as j}from"./index-kPUodEo8.js";import{_ as S}from"./uni-datetime-picker.DRIKtVnu.js";import{_ as T}from"./su-tabs.BcL6QNZj.js";import{_ as N}from"./su-sticky.B6SSP8sh.js";import{_ as M}from"./s-empty.B9iGK6-f.js";import{_ as H}from"./uni-load-more.8Kzkyk-l.js";import{S as Y}from"./s-layout.ChN2kRO2.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{c as z}from"./concat.CXHZS4ws.js";const C=$({__name:"score",setup($){const C=2*a.$platform.device.statusBarHeight,F=t((()=>a.$store("user").userInfo)),V=a.$platform.navbar,D=e({currentTab:0,pagination:{list:0,total:0,pageSize:6,pageNo:1},loadStatus:"",date:[],today:""}),I=[{name:"全部",value:"all"},{name:"收入",value:"true"},{name:"支出",value:"false"}],P=t((()=>D.date[0]===D.date[1]?D.date[0]:D.date.join("~")));async function B(){D.loadStatus="loading";let{code:a,data:t}=await u.getPointRecordPage({pageNo:D.pagination.pageNo,pageSize:D.pagination.pageSize,addStatus:D.currentTab>0?I[D.currentTab].value:void 0,"createTime[0]":D.date[0]+" 00:00:00","createTime[1]":D.date[1]+" 23:59:59"});0===a&&(D.pagination.list=z(D.pagination.list,t.list),D.pagination.total=t.total,D.loadStatus=D.pagination.list.length<D.pagination.total?"more":"noMore")}function E(a){D.currentTab=a.index,h(D.pagination),B()}function G(a){D.date[0]=a[0],D.date[1]=a[a.length-1],h(D.pagination),B()}function R(){"noMore"!==D.loadStatus&&(D.pagination.pageNo++,B())}return s((()=>{D.today=o().format("YYYY-MM-DD"),D.date=[D.today,D.today],B()})),l((()=>{R()})),(t,e)=>{const s=k,o=w,l=j,u=n(i("uni-datetime-picker"),S),h=n(i("su-tabs"),T),$=n(i("su-sticky"),N),z=n(i("s-empty"),M),B=n(i("uni-load-more"),H),U=n(i("s-layout"),Y);return c(),r(U,{class:"wallet-wrap",title:"我的积分",navbar:"inner"},{default:d((()=>[p(s,{class:"header-box ss-flex ss-flex-col ss-row-center ss-col-center",style:g([{marginTop:"-"+Number(C+88)+"rpx",paddingTop:Number(C+88)+"rpx"}])},{default:d((()=>[p(s,{class:"header-bg"},{default:d((()=>[p(s,{class:"bg"})])),_:1}),p(s,{class:"score-box ss-flex-col ss-row-center ss-col-center"},{default:d((()=>[p(s,{class:"ss-m-b-30"},{default:d((()=>[p(o,{class:"all-title ss-m-r-8"},{default:d((()=>[m("当前积分")])),_:1})])),_:1}),p(o,{class:"all-num"},{default:d((()=>[m(f(F.value.point||0),1)])),_:1})])),_:1})])),_:1},8,["style"]),p($,{customNavHeight:_(V)},{default:d((()=>[p(s,{class:"filter-box ss-p-x-30 ss-flex ss-col-center ss-row-between"},{default:d((()=>[p(u,{modelValue:D.date,"onUpdate:modelValue":e[0]||(e[0]=a=>D.date=a),type:"daterange",onChange:G,end:D.today},{default:d((()=>[p(l,{class:"ss-reset-button date-btn"},{default:d((()=>[p(o,null,{default:d((()=>[m(f(P.value),1)])),_:1}),p(o,{class:"cicon-drop-down ss-seldate-icon"})])),_:1})])),_:1},8,["modelValue","end"])])),_:1}),p(h,{list:I,onChange:E,scrollable:!1,current:D.currentTab},null,8,["current"])])),_:1},8,["customNavHeight"]),p(s,{class:"list-box"},{default:d((()=>[D.pagination.total>0?(c(),r(s,{key:0},{default:d((()=>[(c(!0),y(x,null,b(D.pagination.list,(t=>(c(),r(s,{class:"list-item ss-flex ss-col-center ss-row-between",key:t.id},{default:d((()=>[p(s,{class:"ss-flex-col"},{default:d((()=>[p(s,{class:"name"},{default:d((()=>[m(f(t.title)+f(t.description?" - "+t.description:""),1)])),_:2},1024),p(s,{class:"time"},{default:d((()=>[m(f(_(a).$helper.timeFormat(t.createTime,"yyyy-mm-dd hh:MM:ss")),1)])),_:2},1024)])),_:2},1024),t.point>0?(c(),r(s,{key:0,class:"add"},{default:d((()=>[m("+"+f(t.point),1)])),_:2},1024)):(c(),r(s,{key:1,class:"minus"},{default:d((()=>[m(f(t.point),1)])),_:2},1024))])),_:2},1024)))),128))])),_:1})):(c(),r(z,{key:1,text:"暂无数据",icon:"/static/data-empty.png"}))])),_:1}),D.pagination.total>0?(c(),r(B,{key:0,status:D.loadStatus,"content-text":{contentdown:"上拉加载更多"},onClick:R},null,8,["status"])):v("",!0)])),_:1})}}},[["__scopeId","data-v-071daf1b"]]);export{C as default};
