import{v as e,j as t,f as i,w as s,k as a,y as o,az as l,aA as n,i as r,aB as d,c as u,r as p,e as c,A as m,l as h,F as y,m as v,u as g,s as f,g as b,p as $,t as _,aC as w,aD as S,q as E,U as x,V as T}from"./index-kPUodEo8.js";import{_ as H}from"./_plugin-vue_export-helper.BCo6x5W8.js";const N={data:()=>({video:null,num:"",options:{}}),mounted(){this.initVideoEvent()},methods:{initVideoEvent(){setTimeout((()=>{let e=document.getElementById(`dom-html-video_${this.num}`);this.video=e,e.addEventListener("play",(()=>{this.$ownerInstance.callMethod("videoEvent","play")})),e.addEventListener("pause",(()=>{this.$ownerInstance.callMethod("videoEvent","pause")})),e.addEventListener("ended",(()=>{this.$ownerInstance.callMethod("videoEvent","ended"),this.$ownerInstance.callMethod("resetEventDrive")}))}),100)},eventHandle(e){e&&(this.video=document.getElementById(`dom-html-video_${this.num}`),"play"===e?this.video.play():"pause"===e?this.video.pause():"stop"===e&&this.video.stop())},srcChange(e){this.initVideoEvent(),setTimeout((()=>{let e=document.getElementById(`dom-html-video_${this.num}`);e.addEventListener("loadedmetadata",(()=>{let{autoplay:t}=this.options;e.play(),t||e.pause()}))}),0)},propsChange(e){this.options=e},randomNumChange(e){this.num=e}}},P=e=>{e.$renderjs||(e.$renderjs=[]),e.$renderjs.push("domVideo"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.domVideo=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),e.mixins.push(N)};P({props:{src:{type:String,default:""},autoplay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},controls:{type:Boolean,default:!1},objectFit:{type:String,default:"contain"},muted:{type:Boolean,default:!1},poster:{type:String,default:""}},data:()=>({videoHtml:"",videoSrc:"",eventDrive:null,videoProps:{},randomNum:Math.floor(1e8*Math.random()+1)}),watch:{src:{handler(e){e&&(this.initVideoHtml(),setTimeout((()=>{this.videoSrc=e}),0))},immediate:!0},autoplay:{handler(e){this.videoProps.autoplay=e},immediate:!0}},mounted(){this.initVideoHtml()},methods:{videoEvent(e){this.$emit(e)},initVideoHtml(){this.videoHtml=`<video\n          src="${this.src}"\n          id="dom-html-video_${this.randomNum}"\n          class="dom-html-video"\n          ${this.autoplay?"autoplay":""}\n          ${this.loop?"loop":""}\n          ${this.controls?"controls":""}\n          ${this.muted?"muted":""}\n          ${this.poster?'poster="'+this.poster+'"':""}\n          preload="auto"\n          playsinline\n          webkit-playsinline\n          width="100%"\n          height="100%"\n          style="object-fit: ${this.objectFit};padding:0;"\n        >\n          <source src="${this.src}" type="video/mp4">\n          <source src="${this.src}" type="video/ogg">\n          <source src="${this.src}" type="video/webm">\n        </video>\n      `},resetEventDrive(){this.eventDrive=null},play(){this.eventDrive="play"},pause(){this.eventDrive="pause"},stop(){this.eventDrive="stop"}}});const k=H({__name:"su-video",props:{moveX:{type:[Number],default:0},uid:{type:[Number,String],default:0},height:{type:Number,default:300},width:{type:Number,default:750},initialTime:{type:Number,default:0},src:{type:String,default:""},poster:{type:String,default:"https://img1.baidu.com/it/u=1601695551,235775011&fm=26&fmt=auto"}},emits:["videoTimeupdate"],setup(u,{expose:p,emit:c}){const m=d(),h=e({enableProgressGesture:!1,showModal:!1}),y=u,v=c,g=e=>{v("videoTimeupdate",e)},f=e=>{console.log("视频错误信息:",e.target.errMsg)},b=()=>{console.log("视频开始")},$=()=>{console.log("视频暂停")},_=()=>{console.log("视频结束")};return p({pausePlay:()=>{l(`sVideo${y.index}`,m).pause()}}),(e,l)=>{const d=n,p=r;return t(),i(p,{class:"ui-video-wrap"},{default:s((()=>[a(d,{id:`sVideo${u.uid}`,class:"radius",style:o([{height:u.height+"rpx"}]),src:u.src,controls:"","object-fit":"contain","enable-progress-gesture":h.enableProgressGesture,"initial-time":u.initialTime,"x5-video-player-type":"h5","x-webkit-airplay":"allow","webkit-playsinline":"true",onError:f,onTimeupdate:g,onPlay:b,onPause:$,onEnded:_,poster:u.poster},null,8,["id","style","src","enable-progress-gesture","initial-time","poster"])])),_:1})}}},[["__scopeId","data-v-d808600b"]]),B=H({__name:"su-swiper",props:{circular:{type:Boolean,default:!0},autoplay:{type:Boolean,default:!1},interval:{type:Number,default:3e3},duration:{type:Number,default:500},mode:{type:String,default:"default"},imageMode:{type:String,default:"scaleToFill"},list:{type:Array,default:()=>[]},dotStyle:{type:String,default:"long"},dotCur:{type:String,default:"ss-bg-opactity-block"},bg:{type:String,default:"bg-none"},height:{type:Number,default:0},imgHeight:{type:Number,default:0},imgTopRadius:{type:Number,default:0},imgBottomRadius:{type:Number,default:0},isPreview:{type:Boolean,default:!1},seizeHeight:{type:Number,default:200}},setup(l){const n=e({imgHeight:0,cur:0,moveX:0,videoPlaySataus:!1,heightList:[]}),d=e({videoRef:{}}),H=l,N=e=>{"touch"!==e.detail.source&&"autoplay"!==e.detail.source||(n.cur=e.detail.current,n.videoPlaySataus=!1,"video"===H.list[n.cur].type&&d.videoRef[`video_${n.cur}`].pausePlay())},P=()=>{if(!H.isPreview)return;let e=w(H.list);e.forEach(((t,i)=>{"video"===t.type&&e.splice(i,1)})),S({urls:e.length<1?[H.src]:e.reduce(((e,t)=>(e.push(t.src),e)),[]),current:n.cur})},B=e=>{},V=e=>{n.moveX=0},C=e=>{H.list[n.cur].currentTime=e.detail.currentTime},j=u((()=>{let e;return 0!==H.height&&(e=H.height),0===H.height&&(0!==n.imgHeight?e=n.imgHeight:0!==H.seizeHeight&&(e=H.seizeHeight)),{height:e+"rpx"}}));function I(e){if(0===H.height){let t=e.detail.height/e.detail.width*750;n.imgHeight<t&&(n.imgHeight=t)}}return(e,u)=>{const w=E,S=p(c("su-video"),k),M=r,D=x,L=T;return t(),i(M,null,{default:s((()=>[a(M,{class:m(["ui-swiper",[H.mode,H.bg,H.ui]])},{default:s((()=>[a(L,{circular:H.circular,current:n.cur,autoplay:H.autoplay&&!n.videoPlaySataus,interval:H.interval,duration:H.duration,onTransition:B,onAnimationfinish:V,style:o(j.value),onChange:N},{default:s((()=>[(t(!0),h(y,null,v(H.list,((e,o)=>(t(),i(D,{class:m(["swiper-item",{cur:n.cur==o}]),key:o,onClick:t=>(e=>{"video"===e.type?n.videoPlaySataus=!0:(f.$router.go(e.url),P())})(e)},{default:s((()=>[a(M,{class:"ui-swiper-main"},{default:s((()=>["image"===e.type?(t(),i(w,{key:0,class:"swiper-image",mode:H.imageMode,src:e.src,width:"100%",height:"100%",onLoad:I},null,8,["mode","src"])):(t(),i(S,{key:1,ref_for:!0,ref:e=>d.videoRef[`video_${o}`]=e,poster:g(f).$url.cdn(e.poster),src:g(f).$url.cdn(e.src),index:o,moveX:n.moveX,initialTime:e.currentTime||0,height:l.seizeHeight,onVideoTimeupdate:C},null,8,["poster","src","index","moveX","initialTime","height"]))])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["circular","current","autoplay","interval","duration","style"]),n.videoPlaySataus?b("",!0):(t(),h(y,{key:0},["tag"!=H.dotStyle?(t(),i(M,{key:0,class:m(["ui-swiper-dot",H.dotStyle])},{default:s((()=>[(t(!0),h(y,null,v(H.list,((e,s)=>(t(),i(M,{class:m(["line-box",[n.cur==s?"cur":"",H.dotCur]]),key:s},null,8,["class"])))),128))])),_:1},8,["class"])):b("",!0),"tag"==H.dotStyle?(t(),i(M,{key:1,class:m(["ui-swiper-dot",H.dotStyle])},{default:s((()=>[a(M,{class:m(["ui-tag radius-lg",[H.dotCur]]),style:{"pointer-events":"none",padding:"0 10rpx"}},{default:s((()=>[a(M,{style:{transform:"scale(0.7)"}},{default:s((()=>[$(_(n.cur+1)+" / "+_(H.list.length),1)])),_:1})])),_:1},8,["class"])])),_:1},8,["class"])):b("",!0)],64))])),_:1},8,["class"])])),_:1})}}},[["__scopeId","data-v-35b5abdd"]]);export{B as _,k as a};
